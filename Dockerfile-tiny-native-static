FROM ubuntu:22.04

RUN groupadd -g 10001 group
RUN useradd -u 10001 -g 10001 user

FROM scratch

COPY --from=0 /etc/group /etc/group
COPY --from=0 /etc/passwd /etc/passwd
COPY --from=0 --chown=user:group /tmp /tmp

USER user

ARG path=target/tiny

COPY --chown=user:group $path /tiny
ENTRYPOINT ["/tiny"]
